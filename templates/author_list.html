{% extends "base.html" %}
{% block title %} - 艺术家{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1><i class="fas fa-user-tie"></i> 艺术家档案</h1>
    <div class="col-md-4">
        <form method="get" action="{{ url_for('authors') }}" class="input-group">
            <input type="text" name="search" class="form-control" placeholder="搜索艺术家..." value="{{ request.args.get('search', '') }}">
            <button class="btn btn-primary" type="submit">
                <i class="fas fa-search"></i>
            </button>
        </form>
    </div>
</div>

<!-- 时代和国家筛选 - 表单提交版 -->
<form method="get" action="{{ url_for('authors') }}" class="row mb-4">
    <div class="col-md-3">
        <select name="era" class="form-select" onchange="this.form.submit()">
            <option value="">所有时代</option>
            {% for e in eras %}
            <option value="{{ e }}" {% if current_era == e %}selected{% endif %}>{{ e }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="col-md-3">
        <select name="country" class="form-select" onchange="this.form.submit()">
            <option value="">所有国家</option>
            {% for c in countries %}
            <option value="{{ c }}" {% if current_country == c %}selected{% endif %}>{{ c }}</option>
            {% endfor %}
        </select>
    </div>
    <!-- 可选：保留视图切换（如果需要） -->
    <div class="col-md-3">
        <input type="hidden" name="view" value="{{ view_mode }}">
    </div>
</form>

<!-- 艺术家列表 -->
<div class="row" id="authors-container">
    {% for author in authors %}
    <div class="col-lg-4 col-md-6 mb-4">
        <div class="card h-100 shadow-sm">
            <div class="card-body">
                <h5 class="card-title">{{ author.name }}</h5>
                <p class="card-text">
                    <i class="fas fa-globe"></i> <strong>国家/地区:</strong> {{ author.country or '未知' }}<br>
                    <i class="fas fa-clock"></i> <strong>艺术时代:</strong> {{ author.era or '未知' }}<br>
                    {% if author.birth_year %}
                    <i class="fas fa-calendar"></i> <strong>生卒:</strong> {{ author.birth_year }} - {{ author.death_year or '至今' }}
                    {% endif %}
                </p>
                <p class="card-text text-muted">{{ (author.biography or '暂无详细生平介绍。')[:100] }}...</p>
            </div>
            <div class="card-footer bg-transparent">
                <a href="/author/{{ author.id }}" class="btn btn-outline-primary btn-sm">查看详情</a>
                <a href="/artworks?artist={{ author.name }}" class="btn btn-outline-secondary btn-sm">查看作品</a>
            </div>
        </div>
    </div>
    {% else %}
    <div class="col-12">
        <div class="alert alert-info">
            暂无符合条件的艺术家。
        </div>
    </div>
    {% endfor %}
</div>
{% endblock %}

{# 注意：原有的 scripts 块中的 JavaScript 已经不需要了，可以删除 #}
{% block scripts %}
<!-- 移除原来的 alert 脚本，因为现在使用后端筛选 -->
{% endblock %}